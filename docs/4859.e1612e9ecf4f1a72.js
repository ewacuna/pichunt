"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4859],{4859:(N,m,s)=>{s.r(m),s.d(m,{SearchPageModule:()=>b});var f=s(6814),d=s(6223),v=s(7166),c=s(3582),S=s(8520),p=s(5861),x=s(3997),g=s(2726);const Z=(0,g.fo)("Keyboard");var C=s(3778),e=s(2029),w=s(6593),P=s(2196),T=s(2484),L=s(8144),_=s(708);let M=(()=>{var t;class a{constructor(i){this.el=i,this.swiperElement=i.nativeElement}ngAfterViewInit(){Object.assign(this.el.nativeElement,this.config)}}return(t=a).\u0275fac=function(i){return new(i||t)(e.Y36(e.SBq))},t.\u0275dir=e.lG2({type:t,selectors:[["","appSwiper",""]],inputs:{config:"config"}}),a})();function I(t,a){if(1&t){const r=e.EpF();e.ynx(0),e.TgZ(1,"swiper-slide")(2,"ion-card",2),e.NdJ("click",function(){const o=e.CHM(r).$implicit,l=e.oxw();return e.KtG(l.onSelectCard(o))}),e._UZ(3,"img",3),e.TgZ(4,"ion-card-header")(5,"ion-card-subtitle"),e._uU(6),e.qZA()()()(),e.BQk()}if(2&t){const r=a.$implicit;e.xp6(3),e.s9C("src",r.main_image?r.main_image:"assets/img/card-temp-media.png",e.LSH),e.xp6(3),e.Oqu(r.title)}}let J=(()=>{var t;class a{constructor(i){this.pexelsService=i,this.featuredCollections=[],this.cardSelected=new e.vpe,this.swiperConfig={slidesPerView:2,breakpoints:{320:{slidesPerView:2},576:{slidesPerView:2},768:{slidesPerView:3},992:{slidesPerView:4},1200:{slidesPerView:5}}}}ngOnInit(){var i=this;return(0,p.Z)(function*(){yield i.getCollectionData()})()}getCollectionData(){var i=this;return(0,p.Z)(function*(){if(i.featuredCollections.length>0)for(const n of i.featuredCollections){const o=i.pexelsService.getCollection(n.id);yield(0,_.n)(o).then(l=>{if(l.media.length>0){const h=l.media.find(u=>"Photo"===u.type);h&&(n.main_image=h.src.landscape)}})}})()}onSelectCard(i){this.cardSelected.emit(i)}}return(t=a).\u0275fac=function(i){return new(i||t)(e.Y36(P.U))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-featured-collection"]],inputs:{featuredCollections:"featuredCollections"},outputs:{cardSelected:"cardSelected"},decls:3,vars:2,consts:[["appSwiper","",3,"config"],[4,"ngFor","ngForOf"],["color","light","mode","ios",3,"click"],["alt","Main image from collection",3,"src"]],template:function(i,n){1&i&&(e.TgZ(0,"section")(1,"swiper-container",0),e.YNc(2,I,7,2,"ng-container",1),e.qZA()()),2&i&&(e.xp6(1),e.Q6J("config",n.swiperConfig),e.xp6(1),e.Q6J("ngForOf",n.featuredCollections))},dependencies:[f.sg,c.PM,c.Zi,c.tO,M],styles:["ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{max-height:48px;padding:10px 12px}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),a})();function G(t,a){if(1&t){const r=e.EpF();e.ynx(0),e.TgZ(1,"ion-text")(2,"h4",9),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"app-featured-collection",10),e.NdJ("cardSelected",function(n){e.CHM(r);const o=e.oxw();return e.KtG(o.onSelectCard(n))}),e.qZA(),e.BQk()}if(2&t){const r=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,2,"search.popular_search")),e.xp6(2),e.Q6J("featuredCollections",r.featuredCollection.collections)}}function O(t,a){1&t&&(e.ynx(0),e._UZ(1,"app-clock-loading"),e.BQk())}const A=[{path:"",component:(()=>{var t;class a{constructor(i,n,o){this.titleService=i,this.pexelsService=n,this.helperService=o,this.subs=new C.t,this.photoList=[],this.page=1,this.isLoading=!1,this.isSearching=!1}ngOnInit(){this.titleService.setTitle("PicHunt | Search"),this.searchForm=new d.cw({search:new d.NI("",{nonNullable:!0})}),this.listeningSearch(),this.getFeaturedCollections()}listeningSearch(){this.subs.add=this.searchForm.get("search").valueChanges.pipe((0,x.x)()).subscribe(i=>{i||(this.isSearching=!1,this.page=1,this.photoList=[],this.content.scrollToTop(500).then())})}onSubmit(){var i;this.page=1,this.photoList=[],this.content.scrollToTop(500).then(),this.onSearch((null===(i=this.searchForm.get("search"))||void 0===i?void 0:i.value)||"")}onSearch(i){var o,l,n=this;if(i.length<=0)return this.page=1,this.photoList=[],null===(o=this.infiniteScroll)||void 0===o||o.complete(),void(this.isLoading=!1);this.isSearching=!0,this.subs.add=this.pexelsService.searchQuery(i,this.page).subscribe({next:l=>{var h;this.photoList=[...this.photoList,...l.photos||[]],null===(h=this.infiniteScroll)||void 0===h||h.complete(),this.isLoading=!1,"web"!==(null==g.dV?void 0:g.dV.getPlatform())&&Z.hide().then()},error:(l=(0,p.Z)(function*(h){var u;null===(u=n.infiniteScroll)||void 0===u||u.complete(),n.isLoading=!1,yield n.helperService.showError(null==h?void 0:h.code)}),function(u){return l.apply(this,arguments)})})}onGalleryInfinite(i){var n;this.page=this.page+1,this.isLoading=!0,this.onSearch((null===(n=this.searchForm.get("search"))||void 0===n?void 0:n.value)||"")}getFeaturedCollections(){var n,i=this;this.subs.add=this.pexelsService.getFeaturedCollections().subscribe({next:n=>{this.featuredCollection=n},error:(n=(0,p.Z)(function*(o){yield i.helperService.showError(null==o?void 0:o.code)}),function(l){return n.apply(this,arguments)})})}onSelectCard(i){var n,o;this.page=this.page+1,this.isLoading=!0,null===(n=this.searchForm.get("search"))||void 0===n||n.setValue(i.title),this.searchInput.setFocus().then(),this.onSearch((null===(o=this.searchForm.get("search"))||void 0===o?void 0:o.value)||"")}ngOnDestroy(){this.subs.dispose()}}return(t=a).\u0275fac=function(i){return new(i||t)(e.Y36(w.Dx),e.Y36(P.U),e.Y36(C.W))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-search"]],viewQuery:function(i,n){if(1&i&&(e.Gf(c.W2,5),e.Gf(c.ju,5),e.Gf(c.VI,5)),2&i){let o;e.iGM(o=e.CRH())&&(n.content=o.first),e.iGM(o=e.CRH())&&(n.infiniteScroll=o.first),e.iGM(o=e.CRH())&&(n.searchInput=o.first)}},decls:16,vars:11,consts:[["mode","ios",3,"translucent"],[3,"formGroup","ngSubmit"],["inputmode","search","mode","ios","formControlName","search",3,"placeholder"],[1,"ion-padding"],[4,"ngIf"],[3,"photos"],[3,"ionInfinite"],["infiniteScroll",""],[1,"infinite-scroll-content"],[1,"search_label"],[3,"featuredCollections","cardSelected"]],template:function(i,n){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"ion-toolbar")(6,"form",1),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e._UZ(7,"ion-searchbar",2),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"ion-content",3),e.YNc(10,G,6,4,"ng-container",4),e._UZ(11,"app-gallery-view",5),e.TgZ(12,"ion-infinite-scroll",6,7),e.NdJ("ionInfinite",function(l){return n.onGalleryInfinite(l)}),e.TgZ(14,"div",8),e.YNc(15,O,2,0,"ng-container",4),e.qZA()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(3),e.hij(" ",e.lcZ(4,7,"search.title")," "),e.xp6(3),e.Q6J("formGroup",n.searchForm),e.xp6(1),e.s9C("placeholder",e.lcZ(8,9,"search.search_placeholder")),e.xp6(3),e.Q6J("ngIf",n.featuredCollection&&!n.isSearching),e.xp6(1),e.Q6J("photos",n.photoList),e.xp6(4),e.Q6J("ngIf",n.isLoading))},dependencies:[f.O5,d._Y,d.JJ,d.JL,d.sg,d.u,c.W2,c.Gu,c.ju,c.VI,c.yW,c.wd,c.sr,c.j9,T.p,L.I,J,v.X$],styles:[".search_label[_ngcontent-%COMP%]{margin-bottom:0;color:var(--secondary-color)}"]}),a})()}];let Q=(()=>{var t;class a{}return(t=a).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[S.Bz.forChild(A),S.Bz]}),a})();var V=s(6208);let b=(()=>{var t;class a{}return(t=a).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.ez,d.u5,d.UX,c.Pc,Q,v.aw,V.m]}),a})()}}]);